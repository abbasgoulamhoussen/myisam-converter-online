<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertisseur MyISAM vers Excel - Version en ligne</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tabs {
            display: flex;
            background: rgba(102, 126, 234, 0.1);
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            background: rgba(102, 126, 234, 0.2);
            border-bottom-color: #667eea;
            color: #667eea;
        }

        .tab:hover {
            background: rgba(102, 126, 234, 0.15);
        }

        .tab-content {
            display: none;
            padding: 40px;
        }

        .tab-content.active {
            display: block;
        }

        .upload-zone {
            border: 3px dashed #667eea;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            background: rgba(102, 126, 234, 0.05);
        }

        .upload-zone:hover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .upload-zone.dragover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            margin: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .file-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .file-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .file-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
        }

        .file-info h4 {
            margin: 0;
            color: #333;
            font-size: 1.1em;
        }

        .file-info p {
            margin: 5px 0 0;
            color: #666;
            font-size: 0.9em;
        }

        .file-analysis {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .convert-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e9ecef;
        }

        .convert-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px 50px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 15px 35px rgba(40, 167, 69, 0.3);
        }

        .convert-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(40, 167, 69, 0.4);
        }

        .convert-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .status {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-weight: 500;
            display: none;
        }

        .status.success {
            background: rgba(76, 175, 80, 0.1);
            color: #2e7d32;
            border: 2px solid rgba(76, 175, 80, 0.3);
        }

        .status.error {
            background: rgba(244, 67, 54, 0.1);
            color: #c62828;
            border: 2px solid rgba(244, 67, 54, 0.3);
        }

        .status.info {
            background: rgba(33, 150, 243, 0.1);
            color: #1565c0;
            border: 2px solid rgba(33, 150, 243, 0.3);
        }

        .github-info {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #28a745;
        }

        .github-info h3 {
            color: #28a745;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Fira Code', 'Consolas', monospace;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #333;
        }

        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }

        .hex-viewer {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.4;
            margin-top: 15px;
        }

        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid rgba(255, 193, 7, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            color: #e65100;
        }

        .warning-box h3 {
            color: #f57c00;
            margin-bottom: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading {
            animation: spin 1s linear infinite;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîÑ MyISAM Converter Online</h1>
        <p>Convertisseur de fichiers MyISAM vers Excel - 100% en ligne, sans installation</p>
    </div>

    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="converter">üîß Convertisseur</div>
            <div class="tab" data-tab="github">üöÄ GitHub Deploy</div>
            <div class="tab" data-tab="analysis">üîç Analyse</div>
        </div>

        <!-- Onglet Convertisseur -->
        <div class="tab-content active" id="converter">
            <div class="warning-box">
                <h3>‚ö†Ô∏è Limitation importante</h3>
                <p>Les fichiers MyISAM (.MYD, .MYI, .FRM) sont des formats binaires propri√©taires MySQL. Ce convertisseur peut analyser la structure basique mais une conversion compl√®te n√©cessite un serveur MySQL. Cet outil fournit une analyse pr√©liminaire et des donn√©es de d√©monstration.</p>
            </div>

            <div class="upload-zone" id="uploadZone">
                <h3>üìÅ Glissez-d√©posez vos fichiers MyISAM ici</h3>
                <p>Ou cliquez pour s√©lectionner : .MYD, .MYI, .FRM</p>
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    üìÇ S√©lectionner fichiers
                </button>
                <input type="file" id="fileInput" class="file-input" multiple accept=".MYD,.myd,.MYI,.myi,.FRM,.frm">
            </div>

            <div class="file-list" id="fileList"></div>

            <div class="convert-section">
                <button class="convert-btn" id="convertBtn" disabled>
                    üöÄ Analyser et Convertir vers Excel
                </button>
                <div class="progress" id="progress" style="display: none;">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="status" id="status"></div>
            </div>
        </div>

        <!-- Onglet GitHub -->
        <div class="tab-content" id="github">
            <div class="github-info">
                <h3>üöÄ D√©ployer sur GitHub Pages</h3>
                <p>Suivez ces √©tapes pour avoir votre propre convertisseur en ligne :</p>
            </div>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">1</div>
                    <h4>Cr√©er le repository</h4>
                    <p>Cr√©ez un nouveau repository GitHub public</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">2</div>
                    <h4>Ajouter les fichiers</h4>
                    <p>Copiez le code HTML dans index.html</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">3</div>
                    <h4>Activer Pages</h4>
                    <p>Activez GitHub Pages dans les param√®tres</p>
                </div>
            </div>

            <h3>üìù √âtapes d√©taill√©es :</h3>
            
            <h4>1. Cr√©er le repository GitHub</h4>
            <div class="code-block">
# Aller sur github.com et cr√©er un nouveau repository
# Nom sugg√©r√© : myisam-converter-online
# Cocher "Add a README file"
# Rendre le repository public</div>

            <h4>2. Cr√©er le fichier index.html</h4>
            <div class="code-block">
# Dans votre repository, cliquer "Add file" > "Create new file"
# Nommer le fichier : index.html
# Copier tout le code HTML de cet outil
            </div>
            <button class="copy-btn" onclick="copyFullCode()">üìã Copier le code complet</button>

            <h4>3. Activer GitHub Pages</h4>
            <div class="code-block">
# Aller dans Settings de votre repository
# Scroller jusqu'√† "Pages" dans le menu gauche
# Source : Deploy from a branch
# Branch : main (ou master)
# Folder : / (root)
# Cliquer Save
            </div>

            <h4>4. Acc√©der √† votre site</h4>
            <div class="code-block">
# Votre site sera disponible √† :
# https://[votre-username].github.io/[nom-du-repository]
# Exemple : https://johndoe.github.io/myisam-converter-online
            </div>

            <h4>5. Am√©liorations possibles</h4>
            <div class="code-block">
# Ajouter un domaine personnalis√©
# Personnaliser le design
# Ajouter Google Analytics
# Int√©grer d'autres formats de conversion
            </div>

            <div class="warning-box">
                <h3>üí° Conseil Pro</h3>
                <p>Vous pouvez aussi fork ce projet et le modifier selon vos besoins. GitHub Pages se met √† jour automatiquement √† chaque commit !</p>
            </div>
        </div>

        <!-- Onglet Analyse -->
        <div class="tab-content" id="analysis">
            <h3>üîç Analyse des fichiers MyISAM</h3>
            <p>Cet onglet affiche l'analyse technique de vos fichiers une fois upload√©s.</p>
            
            <div id="analysisResults" style="display: none;">
                <div class="file-analysis">
                    <h4>üìä R√©sultats de l'analyse</h4>
                    <div id="analysisContent"></div>
                </div>
            </div>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üìÑ</div>
                    <h4>Fichier .FRM</h4>
                    <p>Structure de la table, d√©finition des colonnes</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíæ</div>
                    <h4>Fichier .MYD</h4>
                    <p>Donn√©es de la table (format binaire)</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîç</div>
                    <h4>Fichier .MYI</h4>
                    <p>Index de la table pour les performances</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        class MyISAMConverterOnline {
            constructor() {
                this.files = new Map();
                this.initializeEventListeners();
                this.initializeTabs();
                this.initializeDragDrop();
            }

            initializeEventListeners() {
                document.getElementById('fileInput').addEventListener('change', (e) => {
                    this.handleFiles(e.target.files);
                });

                document.getElementById('convertBtn').addEventListener('click', () => {
                    this.convertToExcel();
                });
            }

            initializeTabs() {
                const tabs = document.querySelectorAll('.tab');
                const tabContents = document.querySelectorAll('.tab-content');

                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const targetTab = tab.dataset.tab;
                        
                        tabs.forEach(t => t.classList.remove('active'));
                        tabContents.forEach(tc => tc.classList.remove('active'));
                        
                        tab.classList.add('active');
                        document.getElementById(targetTab).classList.add('active');
                    });
                });
            }

            initializeDragDrop() {
                const uploadZone = document.getElementById('uploadZone');

                uploadZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadZone.classList.add('dragover');
                });

                uploadZone.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    uploadZone.classList.remove('dragover');
                });

                uploadZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadZone.classList.remove('dragover');
                    this.handleFiles(e.dataTransfer.files);
                });
            }

            handleFiles(fileList) {
                const files = Array.from(fileList);
                files.forEach(file => {
                    if (this.isMyISAMFile(file.name)) {
                        this.files.set(file.name, file);
                        this.addFileToList(file);
                    }
                });
                this.updateConvertButton();
            }

            isMyISAMFile(filename) {
                const ext = filename.toLowerCase().split('.').pop();
                return ['myd', 'myi', 'frm'].includes(ext);
            }

            addFileToList(file) {
                const fileList = document.getElementById('fileList');
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const fileType = file.name.toLowerCase().split('.').pop().toUpperCase();
                const fileSize = this.formatFileSize(file.size);
                
                fileItem.innerHTML = `
                    <div class="file-header">
                        <div class="file-icon">${fileType}</div>
                        <div class="file-info">
                            <h4>${file.name}</h4>
                            <p>${fileSize} ‚Ä¢ ${fileType} ‚Ä¢ ${new Date(file.lastModified).toLocaleDateString('fr-FR')}</p>
                        </div>
                    </div>
                    <div class="file-analysis">
                        <strong>Type:</strong> ${this.getFileTypeDescription(fileType)}<br>
                        <strong>Statut:</strong> <span style="color: #28a745;">‚úÖ Pr√™t pour analyse</span>
                    </div>
                `;
                
                fileList.appendChild(fileItem);
            }

            getFileTypeDescription(type) {
                const descriptions = {
                    'FRM': 'Structure de table (d√©finition des colonnes)',
                    'MYD': 'Donn√©es de table (contenu binaire)',
                    'MYI': 'Index de table (cl√©s et performances)'
                };
                return descriptions[type] || 'Fichier MyISAM';
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            updateConvertButton() {
                const convertBtn = document.getElementById('convertBtn');
                convertBtn.disabled = this.files.size === 0;
            }

            async convertToExcel() {
                const convertBtn = document.getElementById('convertBtn');
                const progress = document.getElementById('progress');
                const progressBar = document.getElementById('progressBar');
                const status = document.getElementById('status');

                convertBtn.disabled = true;
                convertBtn.innerHTML = '‚è≥ Analyse en cours...';
                progress.style.display = 'block';

                try {
                    // Simulation du processus d'analyse
                    await this.simulateAnalysis();
                    
                    // Analyse des fichiers
                    const analysisResults = await this.analyzeFiles();
                    
                    // Affichage des r√©sultats
                    this.displayAnalysis(analysisResults);
                    
                    // Cr√©ation du fichier Excel
                    const workbook = this.createExcelFromAnalysis(analysisResults);
                    
                    // T√©l√©chargement
                    const fileName = 'myisam_analysis_' + new Date().toISOString().slice(0,10) + '.xlsx';
                    XLSX.writeFile(workbook, fileName);
                    
                    this.showStatus('‚úÖ Analyse termin√©e ! Fichier Excel g√©n√©r√© avec succ√®s.', 'success');
                    
                } catch (error) {
                    console.error('Erreur:', error);
                    this.showStatus('‚ùå Erreur lors de l\'analyse: ' + error.message, 'error');
                } finally {
                    convertBtn.disabled = false;
                    convertBtn.innerHTML = 'üöÄ Analyser et Convertir vers Excel';
                    progress.style.display = 'none';
                }
            }

            async simulateAnalysis() {
                const steps = [
                    'Lecture des fichiers...',
                    'Analyse de la structure FRM...',
                    'Extraction des m√©tadonn√©es...',
                    'Analyse des donn√©es MYD...',
                    'Traitement des index MYI...',
                    'G√©n√©ration du rapport...'
                ];

                const progressBar = document.getElementById('progressBar');
                
                for (let i = 0; i < steps.length; i++) {
                    this.showStatus(`üîÑ ${steps[i]}`, 'info');
                    progressBar.style.width = ((i + 1) / steps.length * 100) + '%';
                    await new Promise(resolve => setTimeout(resolve, 800));
                }
            }

            async analyzeFiles() {
                const results = {
                    files: [],
                    summary: {
                        totalFiles: this.files.size,
                        totalSize: 0,
                        tableStructure: null,
                        estimatedRows: 0
                    }
                };

                for (const [filename, file] of this.files) {
                    const analysis = await this.analyzeIndividualFile(file);
                    results.files.push(analysis);
                    results.summary.totalSize += file.size;
                }

                // Estimation du nombre de lignes bas√©e sur la taille du fichier MYD
                const mydFile = results.files.find(f => f.type === 'MYD');
                if (mydFile) {
                    results.summary.estimatedRows = Math.floor(mydFile.size / 50); // Estimation grossi√®re
                }

                return results;
            }

            async analyzeIndividualFile(file) {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const buffer = e.target.result;
                        const view = new Uint8Array(buffer);
                        
                        const analysis = {
                            name: file.name,
                            type: file.name.toLowerCase().split('.').pop().toUpperCase(),
                            size: file.size,
                            lastModified: new Date(file.lastModified),
                            hexPreview: this.getHexPreview(view),
                            analysis: this.performBasicAnalysis(view, file.name)
                        };
                        
                        resolve(analysis);
                    };
                    reader.readAsArrayBuffer(file);
                });
            }

            getHexPreview(data, maxBytes = 256) {
                let hex = '';
                const len = Math.min(data.length, maxBytes);
                for (let i = 0; i < len; i += 16) {
                    const offset = i.toString(16).padStart(8, '0');
                    let hexLine = '';
                    let asciiLine = '';
                    
                    for (let j = 0; j < 16 && i + j < len; j++) {
                        const byte = data[i + j];
                        hexLine += byte.toString(16).padStart(2, '0') + ' ';
                        asciiLine += (byte >= 32 && byte <= 126) ? String.fromCharCode(byte) : '.';
                    }
                    
                    hex += `${offset}: ${hexLine.padEnd(48)} |${asciiLine}|\n`;
                }
                return hex;
            }

            performBasicAnalysis(data, filename) {
                const type = filename.toLowerCase().split('.').pop();
                
                switch(type) {
                    case 'frm':
                        return this.analyzeFRMFile(data);
                    case 'myd':
                        return this.analyzeMYDFile(data);
                    case 'myi':
                        return this.analyzeMYIFile(data);
                    default:
                        return { message: 'Type de fichier non reconnu' };
                }
            }

            analyzeFRMFile(data) {
                // Analyse basique du fichier FRM
                const magic = data.slice(0, 2);
                return {
                    message: 'Fichier de structure de table MySQL',
                    magic: Array.from(magic).map(b => b.toString(16)).join(' '),
                    possibleColumns: Math.floor(data.length / 100), // Estimation tr√®s grossi√®re
                    notes: 'Contient la d√©finition de la structure de table'
                };
            }

            analyzeMYDFile(data) {
                return {
                    message: 'Fichier de donn√©es MyISAM',
                    estimatedRecords: Math.floor(data.length / 50),
                    notes: 'Contient les donn√©es de la table en format binaire'
                };
            }

            analyzeMYIFile(data) {
                return {
                    message: 'Fichier d\'index MyISAM',
                    indexSize: data.length,
                    notes: 'Contient les index pour optimiser les requ√™tes'
                };
            }

            displayAnalysis(results) {
                const analysisResults = document.getElementById('analysisResults');
                const analysisContent = document.getElementById('analysisContent');
                
                let html = `
                    <h5>üìä R√©sum√© de l'analyse</h5>
                    <p><strong>Fichiers analys√©s:</strong> ${results.summary.totalFiles}</p>
                    <p><strong>Taille totale:</strong> ${this.formatFileSize(results.summary.totalSize)}</p>
                    <p><strong>Lignes estim√©es:</strong> ${results.summary.estimatedRows.toLocaleString()}</p>
                    <hr>
                `;

                results.files.forEach(file => {
                    html += `
                        <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h6>${file.name} (${file.type})</h6>
                            <p>${file.analysis.message}</p>
                            ${file.analysis.estimatedRecords ? `<p><strong>Enregistrements estim√©s:</strong> ${file.analysis.estimatedRecords}</p>` : ''}
                            ${file.analysis.possibleColumns ? `<p><strong>Colonnes possibles:</strong> ${file.analysis.possibleColumns}</p>` : ''}
                            <details style="margin-top: 10px;">
                                <summary style="cursor: pointer; font-weight: bold;">üîç Aper√ßu hexad√©cimal</summary>
                                <div class="hex-viewer">${file.hexPreview}</div>
                            </details>
                        </div>
                    `;
                });

                analysisContent.innerHTML = html;
                analysisResults.style.display = 'block';

                // Switcher vers l'onglet analyse
                document.querySelector('.tab[data-tab="analysis"]').click();
            }

            createExcelFromAnalysis(results) {
                const workbook = XLSX.utils.book_new();

                // Feuille de r√©sum√©
                const summaryData = [
                    ['ANALYSE MYISAM - RAPPORT COMPLET'],
                    [''],
                    ['Date d\'analyse', new Date().toLocaleString('fr-FR')],
                    ['Nombre de fichiers', results.summary.totalFiles],
                    ['Taille totale', this.formatFileSize(results.summary.totalSize)],
                    ['Lignes estim√©es', results.summary.estimatedRows],
                    [''],
                    ['D√âTAIL DES FICHIERS'],
                    ['Nom', 'Type', 'Taille', 'Date modif', 'Analyse']
                ];

                results.files.forEach(file => {
                    summaryData.push([
                        file.name,
                        file.type,
                        this.formatFileSize(file.size),
                        file.lastModified.toLocaleDateString('fr-FR'),
                        file.analysis.message
                    ]);
                });

                const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
                XLSX.utils.book_append_sheet(workbook, summarySheet, 'R√©sum√©');

                // Feuille de donn√©es d'exemple
                const sampleData = [
                    ['DONN√âES D\'EXEMPLE RECONSTRUITES'],
                    [''],
                    ['Note', 'Ces donn√©es sont une simulation bas√©e sur l\'analyse'],
                    ['', 'Pour des donn√©es r√©elles, utilisez mysqldump ou MySQL Workbench'],
                    [''],
                    ['ID', 'Colonne_1', 'Colonne_2', 'Colonne_3', 'Date_Creation'],
                    [1, 'Donn√©e exemple 1', 'Valeur A', 'Type 1', '2024-01-15'],
                    [2, 'Donn√©e exemple 2', 'Valeur B', 'Type 2', '2024-02-20'],
                    [3, 'Donn√©e exemple 3', 'Valeur C', 'Type 1', '2024-03-10'],
                    [4, 'Donn√©e exemple 4', 'Valeur D', 'Type 3', '2024-04-05'],
                    [5, 'Donn√©e exemple 5', 'Valeur E', 'Type 2', '2024-05-12']
                ];

                // Ajout de donn√©es simul√©es bas√©es sur l'estimation
                const estimatedRows = Math.min(results.summary.estimatedRows, 1000); // Limite √† 1000 pour l'exemple
                for (let i = 6; i <= estimatedRows + 5; i++) {
                    sampleData.push([
                        i - 5,
                        `Donn√©e simul√©e ${i - 5}`,
                        `Valeur ${String.fromCharCode(65 + (i % 26))}`,
                        `Type ${(i % 3) + 1}`,
                        new Date(2024, (i % 12), (i % 28) + 1).toISOString().split('T')[0]
                    ]);
                }

                const dataSheet = XLSX.utils.aoa_to_sheet(sampleData);
                XLSX.utils.book_append_sheet(workbook, dataSheet, 'Donn√©es_Simul√©es');

                // Feuille d'instructions
                const instructionsData = [
                    ['INSTRUCTIONS POUR CONVERSION R√âELLE'],
                    [''],
                    ['M√âTHODE 1: mysqldump (Recommand√©e)'],
                    ['Commande', 'mysqldump -u user -p database table > export.sql'],
                    ['Avantages', 'Export complet avec structure et donn√©es'],
                    [''],
                    ['M√âTHODE 2: MySQL Workbench'],
                    ['Action', 'Data Export Wizard > Format CSV/Excel'],
                    ['Avantages', 'Interface graphique, facile √† utiliser'],
                    [''],
                    ['M√âTHODE 3: phpMyAdmin'],
                    ['Action', 'S√©lectionner table > Export > Format Excel'],
                    ['Avantages', 'Interface web, accessible partout'],
                    [''],
                    ['M√âTHODE 4: Commande SQL directe'],
                    ['Commande', 'SELECT * INTO OUTFILE "export.csv" FROM table'],
                    ['Avantages', 'Export direct en CSV'],
                    [''],
                    ['LIMITATION ACTUELLE'],
                    ['Probl√®me', 'Les fichiers .MYD/.MYI/.FRM sont des formats binaires propri√©taires'],
                    ['Solution', 'N√©cessitent un serveur MySQL pour lecture correcte'],
                    ['Alternative', 'Utilisez cet outil pour analyse pr√©liminaire uniquement'],
                    [''],
                    ['RESSOURCES UTILES'],
                    ['Documentation MySQL', 'https://dev.mysql.com/doc/'],
                    ['MySQL Workbench', 'https://dev.mysql.com/downloads/workbench/'],
                    ['Convertisseur GitHub', 'https://github.com/votre-username/myisam-converter']
                ];

                const instructionsSheet = XLSX.utils.aoa_to_sheet(instructionsData);
                XLSX.utils.book_append_sheet(workbook, instructionsSheet, 'Instructions');

                // Feuille d'analyse technique
                const technicalData = [
                    ['ANALYSE TECHNIQUE D√âTAILL√âE'],
                    [''],
                    ['Structure des fichiers MyISAM'],
                    ['']
                ];

                results.files.forEach(file => {
                    technicalData.push([`FICHIER: ${file.name}`]);
                    technicalData.push(['Type', file.type]);
                    technicalData.push(['Taille', this.formatFileSize(file.size)]);
                    technicalData.push(['Analyse', file.analysis.message]);
                    
                    if (file.analysis.magic) {
                        technicalData.push(['Magic bytes', file.analysis.magic]);
                    }
                    if (file.analysis.estimatedRecords) {
                        technicalData.push(['Enregistrements estim√©s', file.analysis.estimatedRecords]);
                    }
                    if (file.analysis.possibleColumns) {
                        technicalData.push(['Colonnes possibles', file.analysis.possibleColumns]);
                    }
                    
                    technicalData.push(['Notes', file.analysis.notes || 'Aucune note suppl√©mentaire']);
                    technicalData.push(['']);
                });

                const technicalSheet = XLSX.utils.aoa_to_sheet(technicalData);
                XLSX.utils.book_append_sheet(workbook, technicalSheet, 'Analyse_Technique');

                return workbook;
            }

            showStatus(message, type = 'info') {
                const status = document.getElementById('status');
                status.textContent = message;
                status.className = `status ${type}`;
                status.style.display = 'block';
            }
        }

        // Fonction pour copier le code complet
        function copyFullCode() {
            const htmlContent = document.documentElement.outerHTML;
            navigator.clipboard.writeText(htmlContent).then(() => {
                alert('‚úÖ Code HTML complet copi√© dans le presse-papiers !\n\nVous pouvez maintenant le coller dans votre fichier index.html sur GitHub.');
            }).catch(() => {
                // Fallback pour les navigateurs qui ne supportent pas l'API clipboard
                const textArea = document.createElement('textarea');
                textArea.value = htmlContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‚úÖ Code copi√© ! Collez-le dans votre index.html sur GitHub.');
            });
        }

        // Initialisation de l'application
        document.addEventListener('DOMContentLoaded', () => {
            new MyISAMConverterOnline();
            
            // Message de bienvenue
            console.log(`
üöÄ MyISAM Converter Online v1.0
================================
‚Ä¢ Analyse des fichiers MyISAM (.MYD, .MYI, .FRM)
‚Ä¢ Export vers Excel avec m√©tadonn√©es
‚Ä¢ D√©ployable sur GitHub Pages
‚Ä¢ 100% c√¥t√© client, aucune donn√©e envoy√©e sur serveur

Pour d√©ployer sur GitHub:
1. Cr√©ez un repository public
2. Ajoutez ce code dans index.html  
3. Activez GitHub Pages
4. Votre convertisseur sera en ligne !

Documentation: https://docs.github.com/en/pages
            `);
        });
    </script>
</body>
</html>